<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="css/style.css" rel="stylesheet"/>
</head>
<body>

<section class="grid" id="app">

    <main>
        <section class="inputForm">

            <form v-on:submit.prevent="addNewItem" id="noteForm">


                <h1>MY NOTES üìö</h1>

                <div class="inputArea">
                    <label for="newItemTitle">Title</label>
                    <p>

                        <input
                                class="inputTitle"
                                id="newItemTitle"
                                placeholder="Title..."
                                v-model="newItemTitle"
                        >
                    </p>

                    <label for="newItemDesc">Content </label><span v-if="validForm">Please enter some text</span>


                    <p>
                <textarea

                        class="inputDesc"
                        id="newItemDesc"
                        placeholder="Enter a note..."
                        v-model="newItemDesc"
                >   </textarea>

                    </p>
                </div>
                <button type="submit">üíæ</button>


            </form>
        </section>
        <article class="agenda-card stats-card">
            <h1>Fun stats! ü§ì</h1>
            <p>Number of notes: {{ showStats }}</p>
            <p>Wordcount: {{ calcWords }}</p>
        </article>

        <div
                is="agenda-item2"
                v-bind:date="item.date"
                v-bind:description="item.description"

                v-bind:key="item.id"
                v-bind:pin="item.pinned"
                v-bind:style="{borderTop: item.color}"
                v-bind:title="item.title"
                v-for="(item, index) in sortedItems"

                v-on:pin="item.pinned = true; item.color = '4px solid cornflowerblue'"
                v-on:remove="items.splice(index, 1)"
        >

        </div>
    </main>
</section>
<script src="js/script.js"></script>
</body>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script>

    Vue.component('agenda-item2', {
        template:
                `
                  <div class="agenda-card">
                  <div class="agenda-card-header">
                    <h3><span v-if="pin">üìå </span>{{ title }} </h3>
                    <div class="agenda-card-button-row">
                      <button v-if="!pin" v-on:click="$emit('pin')">üìå</button>
                      <button v-on:click="$emit('remove')">‚ùå</button>
                    </div>
                  </div>
                  <p>{{ description }} </p>
                  <p class="date">{{ date }}</p>
                  </div>`,
        props: ['title', 'description', 'pin', 'date']
    })

    var app = new Vue({
        el: '#app',
        data: {
            styleObject: {
                borderLeft: 'blue'
            },
            items: [
                {
                    id: 1,
                    title: 'Call someone',
                    description: 'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sat Apr 10 2021'
                },
                {
                    id: 2,
                    title: 'Id 2',
                    description: 'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sun Apr 11 2021'
                },
                {
                    id: 3,
                    title: 'Id 2',
                    description: 'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sun Apr 11 2021'
                },
                {
                    id: 4,
                    title: 'Id 2',
                    description: 'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sun Apr 11 2021'
                },
                {
                    id: 5,
                    title: 'Id 2',
                    description: 'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sun Apr 11 2021'
                },
                {
                    id: 6,
                    title: 'Id 2',
                    description: 'Contact John next week regarding the business plan ' +
                        'Contact John next week regarding the business plan ' +
                        'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sun Apr 11 2021'
                },
                {
                    id: 7,
                    title: 'Id 2',
                    description: 'Contact John next week regarding the business plan',
                    pinned: false,
                    color: '',
                    date: 'Sun Apr 11 2021'
                }
            ],
            nextItemId: 8,
            newItemTitle: '',
            newItemDesc: '',
            stats: '',
            validForm: false
        },
        methods: {
            addNewItem: function () {
                this.items.push({
                    id: this.nextItemId++,
                    title: this.newItemTitle,
                    description: this.newItemDesc,
                    pinned: this.pinned = false,
                    date: this.calcNewDate()
                })
                this.newItemTitle = ''
                this.newItemDesc = ''
            },
            calcNewDate: function () {
                return new Date().toDateString()
            },
            validateForm: function(e) {
                if(this.newItemDesc.length < 1) {
                    this.validForm = false;
                } else {
                    this.validForm = true;
                }
                e.preventDefault();
            }
        },
        computed: {
            sortedItems: function () {
                let sortedAgenda = this.items;

                sortedAgenda = sortedAgenda.sort((a, b) => {
                    return b.pinned - a.pinned;
                })

                return sortedAgenda;
            },
            showStats: function () {
                return this.stats = this.items.length;
            },

            calcWords: function () {
                let countWords = 0

                for (let i = 0; i < this.items.length; i++) {
                    countWords += this.items[i].description.split(" ").length;
                }

                return countWords;
            }
        }
    })
</script>
</html>